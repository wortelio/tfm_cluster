SqueezeNet Classifier. First Test.
DFire Removed wrong images: 0
Starting script

Device: cuda
Learning Rate: 5e-05
Weight Decay: 0
Batch Size: 64
IMG DIMS: (224, 224)
W: 224
H: 224
Using Squeeze Classifier
Model shape is {'smoke': tensor([[0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', grad_fn=<SliceBackward0>), 'fire': tensor([[0.9156],
        [0.0000],
        [0.0000],
        [0.0000]], device='cuda:0', grad_fn=<SliceBackward0>)}
BED Model Arquitecture
SqueezeNet_CLASSIFIER(
  (squeezenet): SqueezeNet(
    (features): Sequential(
      (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(2, 2))
      (1): ReLU(inplace=True)
      (2): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=True)
      (3): Fire(
        (squeeze): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))
        (squeeze_activation): ReLU(inplace=True)
        (expand1x1): Conv2d(16, 64, kernel_size=(1, 1), stride=(1, 1))
        (expand1x1_activation): ReLU(inplace=True)
        (expand3x3): Conv2d(16, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (expand3x3_activation): ReLU(inplace=True)
      )
      (4): Fire(
        (squeeze): Conv2d(128, 16, kernel_size=(1, 1), stride=(1, 1))
        (squeeze_activation): ReLU(inplace=True)
        (expand1x1): Conv2d(16, 64, kernel_size=(1, 1), stride=(1, 1))
        (expand1x1_activation): ReLU(inplace=True)
        (expand3x3): Conv2d(16, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (expand3x3_activation): ReLU(inplace=True)
      )
      (5): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=True)
      (6): Fire(
        (squeeze): Conv2d(128, 32, kernel_size=(1, 1), stride=(1, 1))
        (squeeze_activation): ReLU(inplace=True)
        (expand1x1): Conv2d(32, 128, kernel_size=(1, 1), stride=(1, 1))
        (expand1x1_activation): ReLU(inplace=True)
        (expand3x3): Conv2d(32, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (expand3x3_activation): ReLU(inplace=True)
      )
      (7): Fire(
        (squeeze): Conv2d(256, 32, kernel_size=(1, 1), stride=(1, 1))
        (squeeze_activation): ReLU(inplace=True)
        (expand1x1): Conv2d(32, 128, kernel_size=(1, 1), stride=(1, 1))
        (expand1x1_activation): ReLU(inplace=True)
        (expand3x3): Conv2d(32, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (expand3x3_activation): ReLU(inplace=True)
      )
      (8): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=True)
      (9): Fire(
        (squeeze): Conv2d(256, 48, kernel_size=(1, 1), stride=(1, 1))
        (squeeze_activation): ReLU(inplace=True)
        (expand1x1): Conv2d(48, 192, kernel_size=(1, 1), stride=(1, 1))
        (expand1x1_activation): ReLU(inplace=True)
        (expand3x3): Conv2d(48, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (expand3x3_activation): ReLU(inplace=True)
      )
      (10): Fire(
        (squeeze): Conv2d(384, 48, kernel_size=(1, 1), stride=(1, 1))
        (squeeze_activation): ReLU(inplace=True)
        (expand1x1): Conv2d(48, 192, kernel_size=(1, 1), stride=(1, 1))
        (expand1x1_activation): ReLU(inplace=True)
        (expand3x3): Conv2d(48, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (expand3x3_activation): ReLU(inplace=True)
      )
      (11): Fire(
        (squeeze): Conv2d(384, 64, kernel_size=(1, 1), stride=(1, 1))
        (squeeze_activation): ReLU(inplace=True)
        (expand1x1): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1))
        (expand1x1_activation): ReLU(inplace=True)
        (expand3x3): Conv2d(64, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (expand3x3_activation): ReLU(inplace=True)
      )
      (12): Fire(
        (squeeze): Conv2d(512, 64, kernel_size=(1, 1), stride=(1, 1))
        (squeeze_activation): ReLU(inplace=True)
        (expand1x1): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1))
        (expand1x1_activation): ReLU(inplace=True)
        (expand3x3): Conv2d(64, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (expand3x3_activation): ReLU(inplace=True)
      )
    )
    (classifier): Sequential(
      (0): Dropout(p=0.5, inplace=False)
      (1): Conv2d(512, 1000, kernel_size=(1, 1), stride=(1, 1))
      (2): ReLU(inplace=True)
      (3): AdaptiveAvgPool2d(output_size=(1, 1))
    )
  )
  (model_wo_fc): Sequential(
    (0): Sequential(
      (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(2, 2))
      (1): ReLU(inplace=True)
      (2): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=True)
      (3): Fire(
        (squeeze): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))
        (squeeze_activation): ReLU(inplace=True)
        (expand1x1): Conv2d(16, 64, kernel_size=(1, 1), stride=(1, 1))
        (expand1x1_activation): ReLU(inplace=True)
        (expand3x3): Conv2d(16, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (expand3x3_activation): ReLU(inplace=True)
      )
      (4): Fire(
        (squeeze): Conv2d(128, 16, kernel_size=(1, 1), stride=(1, 1))
        (squeeze_activation): ReLU(inplace=True)
        (expand1x1): Conv2d(16, 64, kernel_size=(1, 1), stride=(1, 1))
        (expand1x1_activation): ReLU(inplace=True)
        (expand3x3): Conv2d(16, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (expand3x3_activation): ReLU(inplace=True)
      )
      (5): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=True)
      (6): Fire(
        (squeeze): Conv2d(128, 32, kernel_size=(1, 1), stride=(1, 1))
        (squeeze_activation): ReLU(inplace=True)
        (expand1x1): Conv2d(32, 128, kernel_size=(1, 1), stride=(1, 1))
        (expand1x1_activation): ReLU(inplace=True)
        (expand3x3): Conv2d(32, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (expand3x3_activation): ReLU(inplace=True)
      )
      (7): Fire(
        (squeeze): Conv2d(256, 32, kernel_size=(1, 1), stride=(1, 1))
        (squeeze_activation): ReLU(inplace=True)
        (expand1x1): Conv2d(32, 128, kernel_size=(1, 1), stride=(1, 1))
        (expand1x1_activation): ReLU(inplace=True)
        (expand3x3): Conv2d(32, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (expand3x3_activation): ReLU(inplace=True)
      )
      (8): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=True)
      (9): Fire(
        (squeeze): Conv2d(256, 48, kernel_size=(1, 1), stride=(1, 1))
        (squeeze_activation): ReLU(inplace=True)
        (expand1x1): Conv2d(48, 192, kernel_size=(1, 1), stride=(1, 1))
        (expand1x1_activation): ReLU(inplace=True)
        (expand3x3): Conv2d(48, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (expand3x3_activation): ReLU(inplace=True)
      )
      (10): Fire(
        (squeeze): Conv2d(384, 48, kernel_size=(1, 1), stride=(1, 1))
        (squeeze_activation): ReLU(inplace=True)
        (expand1x1): Conv2d(48, 192, kernel_size=(1, 1), stride=(1, 1))
        (expand1x1_activation): ReLU(inplace=True)
        (expand3x3): Conv2d(48, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (expand3x3_activation): ReLU(inplace=True)
      )
      (11): Fire(
        (squeeze): Conv2d(384, 64, kernel_size=(1, 1), stride=(1, 1))
        (squeeze_activation): ReLU(inplace=True)
        (expand1x1): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1))
        (expand1x1_activation): ReLU(inplace=True)
        (expand3x3): Conv2d(64, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (expand3x3_activation): ReLU(inplace=True)
      )
      (12): Fire(
        (squeeze): Conv2d(512, 64, kernel_size=(1, 1), stride=(1, 1))
        (squeeze_activation): ReLU(inplace=True)
        (expand1x1): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1))
        (expand1x1_activation): ReLU(inplace=True)
        (expand3x3): Conv2d(64, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (expand3x3_activation): ReLU(inplace=True)
      )
    )
  )
  (pool): AdaptiveAvgPool2d(output_size=(1, 1))
  (smoke): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=512, out_features=1, bias=True)
    (2): ReLU()
  )
  (fire): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=512, out_features=1, bias=True)
    (2): ReLU()
  )
)

Trainable parameters = 1236522
Total parameters = 1236522

Loss Function: BCE

TRAIN DFIRE dataset
DFire Removed wrong images: 0
Train dataset len: 17221

TEST DFire dataset
DFire Removed wrong images: 0
Test dataset len: 4306

***Start Training: 17:51:08

Pretrained Weights

=== EPOCH 0/9 ===
Learning Rate = 5e-05

TRAIN losses
Total Loss  |Smoke Loss  |Fire Loss   
------------ ------------ ------------
0.758       |0.510       |0.248       


TRAIN losses
Total Loss  |Smoke Loss  |Fire Loss   
------------ ------------ ------------
0.438       |0.293       |0.146       


Saving model with new best validation loss: 0.438

=== EPOCH 1/9 ===
Learning Rate = 5e-05

TRAIN losses
Total Loss  |Smoke Loss  |Fire Loss   
------------ ------------ ------------
0.408       |0.257       |0.151       


TRAIN losses
Total Loss  |Smoke Loss  |Fire Loss   
------------ ------------ ------------
0.320       |0.213       |0.106       


Saving model with new best validation loss: 0.320

=== EPOCH 2/9 ===
Learning Rate = 5e-05

TRAIN losses
Total Loss  |Smoke Loss  |Fire Loss   
------------ ------------ ------------
0.330       |0.213       |0.117       


TRAIN losses
Total Loss  |Smoke Loss  |Fire Loss   
------------ ------------ ------------
0.286       |0.197       |0.090       


Saving model with new best validation loss: 0.286

=== EPOCH 3/9 ===
Learning Rate = 5e-05

TRAIN losses
Total Loss  |Smoke Loss  |Fire Loss   
------------ ------------ ------------
0.303       |0.199       |0.104       


TRAIN losses
Total Loss  |Smoke Loss  |Fire Loss   
------------ ------------ ------------
0.267       |0.188       |0.078       


Saving model with new best validation loss: 0.267

=== EPOCH 4/9 ===
Learning Rate = 5e-05

TRAIN losses
Total Loss  |Smoke Loss  |Fire Loss   
------------ ------------ ------------
0.285       |0.191       |0.094       


TRAIN losses
Total Loss  |Smoke Loss  |Fire Loss   
------------ ------------ ------------
0.254       |0.181       |0.072       


Saving model with new best validation loss: 0.254

=== EPOCH 5/9 ===
Learning Rate = 4e-05

TRAIN losses
Total Loss  |Smoke Loss  |Fire Loss   
------------ ------------ ------------
0.273       |0.184       |0.089       


TRAIN losses
Total Loss  |Smoke Loss  |Fire Loss   
------------ ------------ ------------
0.246       |0.177       |0.069       


Saving model with new best validation loss: 0.246

=== EPOCH 6/9 ===
Learning Rate = 4e-05

TRAIN losses
Total Loss  |Smoke Loss  |Fire Loss   
------------ ------------ ------------
0.268       |0.182       |0.086       


TRAIN losses
Total Loss  |Smoke Loss  |Fire Loss   
------------ ------------ ------------
0.242       |0.174       |0.068       


Saving model with new best validation loss: 0.242

=== EPOCH 7/9 ===
Learning Rate = 4e-05

TRAIN losses
Total Loss  |Smoke Loss  |Fire Loss   
------------ ------------ ------------
0.260       |0.177       |0.082       


TRAIN losses
Total Loss  |Smoke Loss  |Fire Loss   
------------ ------------ ------------
0.235       |0.170       |0.065       


Saving model with new best validation loss: 0.235

=== EPOCH 8/9 ===
Learning Rate = 3.2000000000000005e-05

TRAIN losses
Total Loss  |Smoke Loss  |Fire Loss   
------------ ------------ ------------
0.254       |0.174       |0.080       


TRAIN losses
Total Loss  |Smoke Loss  |Fire Loss   
------------ ------------ ------------
0.232       |0.168       |0.064       


Saving model with new best validation loss: 0.232

=== EPOCH 9/9 ===
Learning Rate = 3.2000000000000005e-05

TRAIN losses
Total Loss  |Smoke Loss  |Fire Loss   
------------ ------------ ------------
0.250       |0.171       |0.079       


TRAIN losses
Total Loss  |Smoke Loss  |Fire Loss   
------------ ------------ ------------
0.228       |0.165       |0.063       


Saving model with new best validation loss: 0.228
Saving last model

***Script finished: 18:23:14

Time elapsed: 0:32:05.586794
DFire Removed wrong images: 0
