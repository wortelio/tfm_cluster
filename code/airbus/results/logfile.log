Airbus_256 Dataset

Before View Dataset Examples
Removed wrong images: 0
Removed due to overlapping: 0
Detected more than 3 objects in image: 9
Starting script

Device: cuda
Learning Rate: 0.0005
Batch Size: 64
IMG DIMS: (224, 224)
W: 224
H: 224
SX: 7
SY: 7
B: 2
C: 1

Confidence Threshold: 0.2
IOU mAP Threshold: 0.5
IOU NMS Threshold: 0.5

Using BED 224x224
Model shape is torch.Size([4, 7, 7, 11])
BED Model Arquitecture
OPTIM_BED(
  (model): Sequential(
    (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (2): ReLU()
    (3): Dropout2d(p=0.3, inplace=False)
    (4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (5): Conv2d(64, 24, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (6): BatchNorm2d(24, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (7): ReLU()
    (8): Dropout2d(p=0.3, inplace=False)
    (9): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (10): Conv2d(24, 16, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (11): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (12): ReLU()
    (13): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (14): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (15): ReLU()
    (16): Conv2d(32, 32, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (17): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (18): ReLU()
    (19): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (20): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (21): ReLU()
    (22): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (23): Conv2d(64, 32, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (24): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (25): ReLU()
    (26): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (27): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (28): ReLU()
    (29): Conv2d(64, 32, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (30): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (31): ReLU()
    (32): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (33): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (34): ReLU()
    (35): Conv2d(64, 32, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (36): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (37): ReLU()
    (38): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (39): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (40): ReLU()
    (41): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (42): Conv2d(64, 32, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (43): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (44): ReLU()
    (45): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (46): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (47): ReLU()
    (48): Conv2d(64, 32, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (49): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (50): ReLU()
    (51): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (52): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (53): ReLU()
    (54): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (55): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (56): ReLU()
    (57): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (58): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (59): ReLU()
    (60): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (61): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (62): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (63): ReLU()
    (64): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (65): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (66): ReLU()
    (67): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (68): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (69): ReLU()
    (70): Conv2d(128, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (71): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (72): ReLU()
    (73): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (74): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (75): ReLU()
    (76): Conv2d(16, 11, kernel_size=(1, 1), stride=(1, 1), bias=False)
  )
)

Trainable parameters = 463088
Total parameters = 463088

Using YoloLossMSE_2BBox

TRAIN Airbus dataset
Removed wrong images: 0
Removed due to overlapping: 0
Detected more than 3 objects in image: 113
Train dataset len: 6753

TEST Airbus dataset
Removed wrong images: 0
Removed due to overlapping: 1
Detected more than 3 objects in image: 32
Test dataset len: 5403

***Start Training: 17:46:51


=== EPOCH 0/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
718.922     |103.549     |33.968      |485.764     |70.586      

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
359.138     |31.437      |19.006      |301.720     |6.975       

Saving model with new best validation loss: 359.138

=== EPOCH 1/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
371.357     |69.260      |44.366      |210.651     |22.015      

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
220.731     |23.152      |19.345      |175.256     |2.979       

Saving model with new best validation loss: 220.731

=== EPOCH 2/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
281.689     |61.234      |46.875      |134.369     |14.185      

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
154.533     |18.546      |18.013      |116.809     |1.165       

Saving model with new best validation loss: 154.533

=== EPOCH 3/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
229.998     |54.078      |46.413      |94.422      |10.112      

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
113.985     |16.351      |19.124      |77.615      |0.895       

Saving model with new best validation loss: 113.985

=== EPOCH 4/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
195.941     |50.059      |46.471      |67.571      |6.948       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
82.949      |14.099      |14.941      |52.755      |1.155       

Validation mAP: 0.601

Saving model with new best val mAP: 0.601

Saving model with new best validation loss: 82.949

=== EPOCH 5/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
169.667     |45.445      |47.354      |46.812      |5.262       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
63.237      |12.224      |14.679      |35.836      |0.498       

Saving model with new best validation loss: 63.237

=== EPOCH 6/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
149.964     |40.288      |46.460      |35.561      |2.975       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
57.113      |10.889      |13.403      |32.394      |0.427       

Saving model with new best validation loss: 57.113

=== EPOCH 7/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
133.466     |35.153      |43.678      |28.217      |1.867       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
43.096      |8.937       |13.067      |20.787      |0.305       

Saving model with new best validation loss: 43.096

=== EPOCH 8/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
123.247     |32.252      |40.939      |24.465      |1.188       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
37.957      |7.862       |12.825      |16.970      |0.301       

Saving model with new best validation loss: 37.957

=== EPOCH 9/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
116.849     |30.081      |39.918      |21.495      |1.098       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
35.155      |7.235       |10.931      |16.815      |0.174       

Validation mAP: 0.832

Saving model with new best val mAP: 0.832

Saving model with new best validation loss: 35.155

=== EPOCH 10/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
109.102     |27.023      |37.561      |19.604      |0.817       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
32.815      |6.685       |8.898       |17.076      |0.156       

Saving model with new best validation loss: 32.815

=== EPOCH 11/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
104.999     |25.479      |36.474      |18.353      |0.751       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
29.076      |6.181       |9.449       |13.257      |0.188       

Saving model with new best validation loss: 29.076

=== EPOCH 12/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
101.194     |24.407      |34.653      |17.742      |0.586       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
26.597      |5.703       |9.627       |11.145      |0.122       

Saving model with new best validation loss: 26.597

=== EPOCH 13/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
97.198      |22.743      |33.742      |16.476      |0.567       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
28.677      |6.573       |8.523       |13.477      |0.104       

=== EPOCH 14/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
94.780      |22.254      |32.266      |16.215      |0.510       

Train mAP: 0.799

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
25.849      |5.427       |7.789       |12.528      |0.105       

Validation mAP: 0.890

Saving model with new best val mAP: 0.890

Saving model with new best validation loss: 25.849

=== EPOCH 15/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
91.486      |20.924      |31.211      |15.410      |0.533       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
25.216      |5.308       |9.174       |10.611      |0.123       

Saving model with new best validation loss: 25.216

=== EPOCH 16/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
90.195      |20.323      |30.766      |15.359      |0.464       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
24.251      |5.412       |8.235       |10.511      |0.093       

Saving model with new best validation loss: 24.251

=== EPOCH 17/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
87.872      |19.555      |29.966      |14.809      |0.380       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
23.255      |5.281       |7.504       |10.389      |0.081       

Saving model with new best validation loss: 23.255

=== EPOCH 18/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
85.399      |18.799      |28.767      |14.398      |0.389       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
26.390      |5.221       |7.965       |13.091      |0.113       

=== EPOCH 19/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
84.558      |18.351      |28.764      |14.101      |0.414       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
26.262      |5.732       |6.571       |13.833      |0.125       

Validation mAP: 0.898

Saving model with new best val mAP: 0.898

=== EPOCH 20/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
83.619      |18.012      |28.603      |13.831      |0.354       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
21.044      |4.746       |7.229       |8.997       |0.072       

Saving model with new best validation loss: 21.044

=== EPOCH 21/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
81.082      |16.987      |27.588      |13.489      |0.311       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
20.958      |4.604       |7.266       |9.004       |0.084       

Saving model with new best validation loss: 20.958

=== EPOCH 22/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
80.460      |17.335      |27.054      |13.167      |0.312       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
21.571      |4.432       |6.357       |10.716      |0.066       

=== EPOCH 23/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
78.943      |17.049      |26.112      |13.026      |0.273       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
19.982      |4.316       |6.293       |9.268       |0.105       

Saving model with new best validation loss: 19.982

=== EPOCH 24/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
77.581      |16.237      |25.917      |12.797      |0.254       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
19.315      |4.212       |6.795       |8.241       |0.068       

Validation mAP: 0.922

Saving model with new best val mAP: 0.922

Saving model with new best validation loss: 19.315

=== EPOCH 25/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
76.725      |15.845      |25.723      |12.649      |0.231       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
20.809      |4.121       |5.953       |10.661      |0.075       

=== EPOCH 26/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
75.758      |15.758      |25.207      |12.317      |0.288       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
18.687      |4.030       |6.325       |8.258       |0.074       

Saving model with new best validation loss: 18.687

=== EPOCH 27/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
75.171      |15.572      |24.734      |12.526      |0.242       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
19.379      |4.307       |6.345       |8.638       |0.089       

=== EPOCH 28/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
74.720      |15.481      |24.706      |12.267      |0.254       

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
18.092      |3.962       |5.791       |8.286       |0.052       

Saving model with new best validation loss: 18.092

=== EPOCH 29/29 ===
Learning Rate = 0.0005

TRAIN losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
73.805      |15.105      |24.556      |11.972      |0.241       

Train mAP: 0.882

VAL losses
Total Loss  |Box Loss    |Conf Loss   |No Obj Loss |Class Loss  
------------ ------------ ------------ ------------ ------------
17.633      |3.951       |6.473       |7.152       |0.057       

Validation mAP: 0.925

Saving model with new best val mAP: 0.925

Saving model with new best validation loss: 17.633
Saving last model

***Script finished: 18:01:03

Time elapsed: 0:14:11.869947
